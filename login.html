<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Target Zone ‚Äì Login</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-gradient-to-b from-blue-200 to-blue-100 min-h-screen flex items-center justify-center p-4">
  <div class="w-full max-w-2xl bg-white shadow-xl rounded-2xl p-6">
    <h2 class="text-3xl font-extrabold text-center mb-6 text-indigo-600">
      üîê Target Zone ‚Äì Login
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- UID Login -->
      <div class="border rounded-xl p-5 bg-gray-50">
        <h3 class="text-xl font-bold mb-3 text-gray-700">UID Login</h3>
        <input id="uidInput" type="text" class="w-full mb-3 p-3 border rounded-lg" placeholder="üé´ UID ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
        <input id="uidPass" type="password" class="w-full mb-3 p-3 border rounded-lg" placeholder="üîë Password ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
        <button id="uidLoginBtn" class="w-full bg-indigo-600 text-white py-2 rounded-lg font-semibold">Login with UID</button>
        <p id="uidError" class="text-red-500 text-sm mt-2"></p>
      </div>

      <!-- Email Login -->
      <div class="border rounded-xl p-5 bg-gray-50">
        <h3 class="text-xl font-bold mb-3 text-gray-700">Email Login</h3>
        <input id="email" type="email" class="w-full mb-3 p-3 border rounded-lg" placeholder="üìß Email ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
        <input id="password" type="password" class="w-full mb-3 p-3 border rounded-lg" placeholder="üîê Password ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
        <button id="emailLoginBtn" class="w-full bg-green-600 text-white py-2 rounded-lg font-semibold">Login with Email</button>

        <button id="googleBtn" class="w-full bg-white border mt-3 py-2 rounded-lg font-semibold flex items-center justify-center gap-2">
          <img src="https://upload.wikimedia.org/wikipedia/commons/0/09/Google_logo.svg" width="20"> Sign in with Google
        </button>

        <p class="text-center mt-3 text-sm">
          ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á? <a href="signup.html" class="text-indigo-600 font-semibold">Signup</a>
        </p>
      </div>
    </div>

    <p class="text-center mt-4">
      <a href="admin-login.html" class="text-indigo-600 border px-4 py-2 rounded-lg font-semibold">üõ†Ô∏è Admin Login</a>
    </p>
  </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCR5rqthBh0vX0yLOcOG3b9xJiKbYtzdxU",
  authDomain: "target-zone-8fffd.firebaseapp.com",
  projectId: "target-zone-8fffd",
  storageBucket: "target-zone-8fffd.appspot.com",
  messagingSenderId: "667579216123",
  appId: "1:667579216123:web:37bb1fcc724743073d005e"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// UID Login
document.getElementById("uidLoginBtn").onclick = async () => {
  const uid = document.getElementById("uidInput").value.trim();
  const pass = document.getElementById("uidPass").value.trim();
  const errBox = document.getElementById("uidError");
  errBox.textContent = "";

  if (!uid || !pass) {
    errBox.textContent = "UID ‡¶è‡¶¨‡¶Ç Password ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!";
    return;
  }

  try {
    const q = query(collection(db, "students"), where("uid", "==", uid), where("password", "==", pass));
    const snap = await getDocs(q);
    if (snap.empty) {
      errBox.textContent = "‚ùå ‡¶≠‡ßÅ‡¶≤ UID ‡¶¨‡¶æ Password";
      return;
    }
    const studentId = snap.docs[0].id;
    localStorage.setItem("studentId", studentId);

    Swal.fire({icon:"success",title:"Login Successful!",timer:1500,showConfirmButton:false});
    setTimeout(()=> location.href = "student-dashboard.html", 1500);
  } catch (e) {
    errBox.textContent = e.message || "Login error";
  }
};

// Email Login
document.getElementById("emailLoginBtn").onclick = async () => {
  const email = document.getElementById("email").value.trim();
  const pass = document.getElementById("password").value;
  try {
    await signInWithEmailAndPassword(auth, email, pass);
    Swal.fire({icon:"success",title:"Login Successful!",timer:1500,showConfirmButton:false});
    setTimeout(()=> location.href = "student-dashboard.html", 1500);
  } catch (e) {
    Swal.fire({icon:"error",title:"Login Failed",text:e.message});
  }
};

// Google Login
document.getElementById("googleBtn").onclick = async () => {
  try {
    const provider = new GoogleAuthProvider();
    await signInWithPopup(auth, provider);
    Swal.fire({icon:"success",title:"Google Login Successful!",timer:1500,showConfirmButton:false});
    setTimeout(()=> location.href = "student-dashboard.html", 1500);
  } catch (e) {
    Swal.fire({icon:"error",title:"Google Login Failed",text:e.message});
  }
};
</script>
</body>
</html>
